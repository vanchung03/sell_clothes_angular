
<div class="forgot-password-container" data-aos="fade-up">
    <!-- Loading overlay -->
    <div class="loading-overlay" *ngIf="loading">
      <div class="spinner"></div>
    </div>
  
    <!-- Step 1: Gửi OTP -->
    <div *ngIf="step === 1" class="form-step" data-aos="fade-up">
      <h2><i class="fas fa-key"></i> Quên mật khẩu</h2>
      <form [formGroup]="forgotPasswordForm" (ngSubmit)="sendOTP()">
        <div class="form-group">
          <label for="email"><i class="fas fa-envelope"></i> Email của bạn:</label>
          <div class="input-wrapper">
            <input type="email" id="email" formControlName="email" class="form-control" placeholder="Nhập email của bạn" />
          </div>
          <div *ngIf="forgotPasswordForm.get('email')?.invalid && forgotPasswordForm.get('email')?.touched" class="error">
            <span *ngIf="forgotPasswordForm.get('email')?.errors?.['required']">Vui lòng nhập email.</span>
            <span *ngIf="forgotPasswordForm.get('email')?.errors?.['email']">Vui lòng nhập email hợp lệ.</span>
          </div>
        </div>
        <div class="form-actions">
          <button type="submit" [disabled]="forgotPasswordForm.invalid" class="btn btn-primary">
            <i class="fas fa-paper-plane"></i> Gửi OTP
          </button>
          <span class="back-icon">
            <a routerLink="/auth/login"><i class="fas fa-arrow-left"></i> Quay lại</a>
          </span>
        </div>
      </form>
    </div>
  
    <!-- Step 2: Xác nhận OTP -->
    <div *ngIf="step === 2" class="form-step" data-aos="fade-up">
      <h2><i class="fas fa-lock"></i> Xác nhận OTP</h2>
      <form [formGroup]="otpForm" (ngSubmit)="verifyOTP()">
        <div class="form-group">
          <label for="otp"><i class="fas fa-shield-alt"></i> Mã OTP:</label>
          <div class="input-wrapper">
            <input type="text" id="otp" formControlName="otp" class="form-control" placeholder="Nhập mã OTP" />
          </div>
          <div *ngIf="otpForm.get('otp')?.invalid && otpForm.get('otp')?.touched" class="error">
            <span *ngIf="otpForm.get('otp')?.errors?.['required']">OTP là bắt buộc.</span>
            <span *ngIf="otpForm.get('otp')?.errors?.['minlength']">OTP phải có 6 ký tự.</span>
          </div>
        </div>
        <div class="form-actions">
          <button type="submit" [disabled]="otpForm.invalid" class="btn btn-primary">
            <i class="fas fa-check"></i> Xác nhận OTP
          </button>
          <span class="back-icon" (click)="goBack()">
            <i class="fas fa-arrow-left"></i> Quay lại
          </span>
        </div>
      </form>
    </div>
  
    <!-- Step 3: Đặt lại mật khẩu mới -->
    <div *ngIf="step === 3" class="form-step" data-aos="fade-up">
      <h2><i class="fas fa-user-lock"></i> Đặt mật khẩu mới</h2>
      <form [formGroup]="newPasswordForm" (ngSubmit)="resetPassword()">
        <div class="form-group">
          <label for="newPassword"><i class="fas fa-key"></i> Mật khẩu mới:</label>
          <div class="input-wrapper">
            <input type="password" id="newPassword" formControlName="newPassword" class="form-control" placeholder="Nhập mật khẩu mới" />
          </div>
          <div *ngIf="newPasswordForm.get('newPassword')?.invalid && newPasswordForm.get('newPassword')?.touched" class="error">
            <span *ngIf="newPasswordForm.get('newPassword')?.errors?.['required']">Mật khẩu mới là bắt buộc.</span>
            <span *ngIf="newPasswordForm.get('newPassword')?.errors?.['minlength']">Mật khẩu phải có ít nhất 6 ký tự.</span>
          </div>
        </div>
        <div class="form-group">
          <label for="confirmPassword"><i class="fas fa-lock"></i> Xác nhận mật khẩu:</label>
          <div class="input-wrapper">
            <input type="password" id="confirmPassword" formControlName="confirmPassword" class="form-control" placeholder="Xác nhận mật khẩu mới" />
          </div>
          <div *ngIf="newPasswordForm.get('confirmPassword')?.invalid && newPasswordForm.get('confirmPassword')?.touched" class="error">
            <span *ngIf="newPasswordForm.get('confirmPassword')?.errors?.['required']">Xác nhận mật khẩu là bắt buộc.</span>
          </div>
        </div>
        <div class="form-actions">
          <button type="submit" [disabled]="newPasswordForm.invalid" class="btn btn-primary">
            <i class="fas fa-save"></i> Đặt lại mật khẩu
          </button>
          <span class="back-icon" (click)="goBack()">
            <i class="fas fa-arrow-left"></i> Quay lại
          </span>
        </div>
      </form>
    </div>
  </div>
  