<div class="import-container" data-aos="fade-up">
  <div class="import-card">
    <div class="card-header" data-aos="fade-down" data-aos-delay="200">
      <h2>Import Sản Phẩm từ Excel</h2>
      <p class="subtitle">Tải lên file Excel và thư mục ảnh để nhập sản phẩm</p>
    </div>

    <div class="card-body" data-aos="fade-up" data-aos-delay="300">
      <!-- File selection area -->
      <div class="upload-section" data-aos="fade-right" data-aos-delay="400">
        <div class="upload-box">
          <div class="upload-icon">
            <i class="fas fa-file-excel"></i>
          </div>
          <div class="upload-content">
            <h3>File Excel</h3>
            <p *ngIf="!fileName">Chọn file Excel để nhập dữ liệu sản phẩm</p>
            <p *ngIf="fileName" class="file-selected">{{ fileName }}</p>
            <label class="upload-btn">
              Chọn File
              <input type="file" (change)="onFileSelected($event)" accept=".xlsx" hidden>
            </label>
          </div>
        </div>
      </div>

      <!-- Image folder selection area -->
      <div class="upload-section" data-aos="fade-left" data-aos-delay="500">
        <div class="upload-box">
          <div class="upload-icon">
            <i class="fas fa-images"></i>
          </div>
          <div class="upload-content">
            <h3>Thư Mục Ảnh</h3>
            <p *ngIf="imageCount === 0">Chọn thư mục chứa ảnh sản phẩm</p>
            <p *ngIf="imageCount > 0" class="file-selected">Đã chọn {{ imageCount }} ảnh</p>
            <label class="upload-btn">
              Chọn Thư Mục
              <input type="file" (change)="onFolderSelected($event)" webkitdirectory directory multiple hidden>
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- Progress area -->
    <div class="progress-container" *ngIf="isUploading || uploadComplete" data-aos="fade-up" data-aos-delay="600">
      <div class="progress-status">
        <span *ngIf="isUploading">Đang tải lên... {{ uploadProgress }}%</span>
        <span *ngIf="uploadComplete && uploadSuccess" class="success-msg">Nhập dữ liệu thành công!</span>
        <span *ngIf="uploadComplete && !uploadSuccess" class="error-msg">Có lỗi xảy ra!</span>
      </div>
      <div class="progress-bar-container">
        <div class="progress-bar" [style.width.%]="uploadProgress" [ngClass]="{'complete': uploadProgress === 100}">
        </div>
      </div>
    </div>

    <!-- Action buttons -->
    <div class="action-buttons" data-aos="fade-up" data-aos-delay="700">
      <button class="import-btn" (click)="importProducts()" [disabled]="isUploading || !selectedFile">
        <i class="fas fa-upload"></i> Nhập Sản Phẩm
      </button>
      <button class="reset-btn" (click)="resetForm()" [disabled]="isUploading">
        <i class="fas fa-redo"></i> Làm Mới
      </button>
    </div>
    <!-- Instructions -->
    <div class="card-footer" data-aos="fade-up" data-aos-delay="500">
      <div class="instructions">
        <h4><i class="fas fa-info-circle"></i> Hướng dẫn</h4>
        <ul>
          <li>File Excel phải đúng định dạng với các cột: Mã danh mục, Mã thương hiệu, Tên sản phẩm, Mô tả, Giá, Giá
            khuyến mãi, Trạng thái</li>
          <li>Ảnh sản phẩm nên đặt tên tương tự tên sản phẩm để dễ dàng liên kết</li>
          <li>Hỗ trợ định dạng ảnh: jpg, jpeg, png, webp</li>
        </ul>
      </div>
       <div class="action-btn">
        <!-- Importing data instructions -->
      <div>
        <button class="btn" routerLink="/admin/products">
          <i class="fas fa-arrow-left"></i> Quay Lại
        </button>
      </div>
      <div>
        <button class="download-btn" (click)="downloadTemplate()">
          <i class="fas fa-file-excel"></i> Tải File Mẫu
        </button>
      </div>

      <!-- Instructions for adding products -->
       </div>
      
    </div>
  </div>
</div>