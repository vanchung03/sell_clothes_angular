<mat-dialog-content class="add-user-container">
  <h2 class="title">Thêm Người Dùng</h2>

  <!-- ✅ Upload Avatar -->
  <div class="form-group">
    <mat-label>Ảnh đại diện</mat-label>
    <input type="file" id="avatar" (change)="onFileSelected($event)" accept="image/*" hidden />
    <div class="avatar-wrapper" (click)="triggerFileInput()">
      <img *ngIf="avatarPreview" [src]="avatarPreview" class="avatar-preview" />
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-scan-face"><path d="M3 7V5a2 2 0 0 1 2-2h2"/><path d="M17 3h2a2 2 0 0 1 2 2v2"/><path d="M21 17v2a2 2 0 0 1-2 2h-2"/><path d="M7 21H5a2 2 0 0 1-2-2v-2"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><path d="M9 9h.01"/><path d="M15 9h.01"/></svg>
    </div>
    <mat-progress-bar *ngIf="isUploading" mode="indeterminate"></mat-progress-bar>
  </div>

  <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
    <div class="form-grid">
      <mat-form-field appearance="outline">
        <mat-label>Username</mat-label>
        <input matInput formControlName="username" placeholder="Nhập username" />
        <mat-error *ngIf="userForm.controls['username'].invalid && userForm.controls['username'].touched">
          Username ít nhất 3 ký tự
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Email</mat-label>
        <input matInput type="email" formControlName="email" placeholder="Nhập email" />
        <mat-error *ngIf="userForm.controls['email'].invalid && userForm.controls['email'].touched">
          Email không hợp lệ
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Password</mat-label>
        <input matInput type="password" formControlName="password" placeholder="Nhập mật khẩu" />
        <mat-error *ngIf="userForm.controls['password'].invalid && userForm.controls['password'].touched">
          Mật khẩu ít nhất 6 ký tự
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Số điện thoại</mat-label>
        <input matInput type="text" formControlName="phone" placeholder="Nhập số điện thoại" />
        <mat-error *ngIf="userForm.controls['phone'].invalid && userForm.controls['phone'].touched">
          Số điện thoại không hợp lệ
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Họ và Tên</mat-label>
        <input matInput type="text" formControlName="fullName" placeholder="Nhập họ và tên" />
      </mat-form-field>
    </div>

    <div class="button-group">
      <button mat-raised-button type="submit" [disabled]="isSubmitting">
        <i class="fa-solid fa-floppy-disk"></i>
        {{ isSubmitting ? "Đang lưu..." : " Lưu Thông Tin" }}
      </button>
    </div>
  </form>
</mat-dialog-content>
