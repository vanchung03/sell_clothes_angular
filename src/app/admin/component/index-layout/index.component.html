<mat-sidenav-container class="main-container">
  <!-- Sidebar -->
  <mat-sidenav #sidenav mode="side" opened class="sidenav">
    <mat-toolbar class="sidenav-header">
      <div class="profile-info">
        <img
          src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRkn4MQj0v--Ku2CsK_xS1JOJZEkTMFFIFrg4EpQFMNCUcqsrmZ_4XWE6BeILEiAug3J8A&usqp=CAU"
          alt="Avatar" class="avatar" />
        <div class="user-details">
          <span class="namestore">SERENITY</span>
          <span class="status">Online</span>
        </div>
      </div>
    </mat-toolbar>

    <mat-nav-list class="nav-bar">
      <!-- Dashboard -->
      <a mat-list-item routerLink="/dashboard" routerLinkActive="active-menu" class="menu-item">
        <mat-icon>home</mat-icon>
        <span>Dashboard</span>
      </a>

      <!-- Nested Menu for Users -->
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            <mat-icon>person</mat-icon>
            <span>Quản Lý Người Dùng</span>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <mat-nav-list>
          <a mat-list-item routerLink="/users" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>list</mat-icon>
            <span>Danh Sách Người Dùng </span>
          </a>
          <a mat-list-item routerLink="/add-user" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>account_circle</mat-icon>
            <span>Thêm Người Dùng</span>
          </a>
        </mat-nav-list>
      </mat-expansion-panel>

      <!-- Nested Menu for Roles -->
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            <mat-icon>account_circle</mat-icon>
            <span>Quản Lý Vai Trò</span>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <mat-nav-list>
          <a mat-list-item routerLink="/roles" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>list</mat-icon>
            <span>Danh Vai Trò</span>
          </a>
          <!-- <a mat-list-item routerLink="#" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>account_circle</mat-icon>
            <span>Thêm Quyền</span>
          </a> -->
        </mat-nav-list>
      </mat-expansion-panel>

      <!-- Nested Menu for Products -->
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            <mat-icon>shopping_bag</mat-icon>
            <span>Quản Lý Sản Phẩm</span>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <mat-nav-list>
          <a mat-list-item routerLink="/products" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>list</mat-icon>
            <span>Danh Sách Sản Phẩm</span>
          </a>
          <a mat-list-item routerLink="add-product" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>shopping_bag</mat-icon>
            <span>Thêm Sản Phẩm</span>
          </a>
          <!-- <a mat-list-item routerLink="add-excel-product" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>shopping_bag</mat-icon>
            <span>Thêm Sản Phẩm EXCEL</span>
          </a> -->
          <!-- <a mat-list-item routerLink="/product-image" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>image</mat-icon>
            <span>Product Image</span>
          </a>
          <a mat-list-item routerLink="/product-size" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>straighten</mat-icon>
            <span>Product Size</span>
          </a> -->
        </mat-nav-list>
      </mat-expansion-panel>

      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            <mat-icon>card_giftcard</mat-icon> <!-- Icon quà tặng, có thể phù hợp với voucher -->
            <span>Quản Lý Voucher</span>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <mat-nav-list>
          <a mat-list-item routerLink="/vouchers" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>list</mat-icon>
            <span>Danh Sách Voucher </span>
          </a>
          <!-- <a mat-list-item routerLink="/add-user" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>account_circle</mat-icon>
            <span>Thêm Voucher</span>
          </a> -->
        </mat-nav-list>
      </mat-expansion-panel>

      <!-- Nested Menu for Users -->
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            <mat-icon>category</mat-icon>
            <span>Thương hiệu & Danh mục</span>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <mat-nav-list>
          <a mat-list-item routerLink="/brand" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>list</mat-icon>
            <span>Thương Hiệu</span>
          </a>
          <a mat-list-item routerLink="/category" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>category</mat-icon>
            <span>Danh Mục</span>
          </a>
        </mat-nav-list>
      </mat-expansion-panel>

      <!-- Nested Menu for Orders -->
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            <mat-icon>shopping_cart</mat-icon>
            <span>Quản Lý Đơn Hàng</span>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <mat-nav-list>
          <!-- All Orders -->
          <a mat-list-item routerLink="/order" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>list</mat-icon>
            <span>Danh Sách Đơn Hàng</span>
          </a>
          <!-- Pending Orders -->
          <!-- <a mat-list-item routerLink="/pending-orders" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>hourglass_empty</mat-icon>
            <span>Pending Orders</span>
          </a> -->
          <!-- Completed Orders -->
          <!-- <a mat-list-item routerLink="/completed-orders" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>check_circle</mat-icon>
            <span>Completed Orders</span>
          </a> -->
          <!-- Cancelled Orders -->
          <!-- <a mat-list-item routerLink="/cancelled-orders" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>cancel</mat-icon>
            <span>Cancelled Orders</span>
          </a> -->
        </mat-nav-list>
      </mat-expansion-panel>
       <!-- Nested Menu for Orders -->
       <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            <mat-icon>history</mat-icon>
            <span>Lịch Sử GD</span>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <mat-nav-list>
          <!-- All Orders -->
          <a mat-list-item routerLink="/payment" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>history</mat-icon>
            <span>Giao Dịch</span>
          </a>
          <a mat-list-item routerLink="/payment-history" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>history</mat-icon>
            <span>Lịch Sử</span>
          </a>
    
        </mat-nav-list>
      </mat-expansion-panel>

      <!-- Nested Menu for Reports -->
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            <mat-icon>bar_chart</mat-icon>
            <span>Thống Kê Báo Cáo</span>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <mat-nav-list>
          <!-- Revenue Report -->
          <a mat-list-item routerLink="/reports" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>show_chart</mat-icon>
            <span>Thống Kê Doanh Thu</span>
          </a>
          <a mat-list-item routerLink="/product-summary" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>show_chart</mat-icon>
            <span>Thống Kê Sản Phẩm Tồn Kho</span>
          </a>
          <!-- Sales Report -->
          <!-- <a mat-list-item routerLink="/reports" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>show_chart</mat-icon>
            <span>Report ALL</span>
          </a> -->
          <!-- Product Performance -->
          <!-- <a mat-list-item routerLink="/product-performance" routerLinkActive="active-menu" class="submenu-item">
            <mat-icon>insights</mat-icon>
            <span>Product Performance</span>
          </a> -->
        </mat-nav-list>
      </mat-expansion-panel>


      <!-- Settings -->
      <a mat-list-item routerLink="/settings" routerLinkActive="active-menu" class="menu-item">
        <mat-icon>settings</mat-icon>
        <span>Cài Đặt</span>
      </a>
    </mat-nav-list>
  </mat-sidenav>

  <!-- Main Content -->
  <mat-sidenav-content>
    <!-- Toolbar -->
    <mat-toolbar class="toolbar">
      <button mat-icon-button (click)="sidenav.toggle()">
        <mat-icon>menu</mat-icon>
      </button>
      <span class="title">Home</span>
      <span class="spacer"></span>
      <button mat-icon-button>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bell-dot"><path d="M10.268 21a2 2 0 0 0 3.464 0"/><path d="M13.916 2.314A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.74 7.327A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673 9 9 0 0 1-.585-.665"/><circle cx="18" cy="8" r="3"/></svg>
        <span class="badge">3</span>
      </button>
      <button mat-icon-button>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-mail"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
        <span class="badge">5</span>
      </button>
      <!-- <button mat-icon-button>
        <mat-icon>brightness_3</mat-icon>
      </button> -->
      <div class="profile-menu" (mouseenter)="showMenu = true" (mouseleave)="showMenu = false">
        <img [src]="user.avatar" alt="Avatar" class="avatar" />
          <span class="username-username">{{ user.fullName | uppercase}}</span>
        <div class="profile-dropdown" *ngIf="showMenu">
          <button mat-menu-item (click)="toggleProfileForm()">
            <mat-icon>person</mat-icon>
            <span>Thông Tin Cá nhân</span>
          </button>
          <button mat-menu-item (click)="logout()">
            <mat-icon>logout</mat-icon>
            <span> Đăng Xuất</span>
          </button>
        </div>
      </div>
    </mat-toolbar>

    <div *ngIf="isProfileFormVisible" class="profile-form visible">
      <div class="profile-form-container">
        <button class="close-btn" (click)="isProfileFormVisible = false">
          <i class="fas fa-times text-danger"></i>
        </button>
    
        <!-- Chỉnh sửa & Lưu -->
        <div class="form-actions">
          <button *ngIf="!isEditing" class="edit-btn" (click)="startEditing()">
            <mat-icon>edit</mat-icon> Sửa thông tin
          </button>
          
          <button *ngIf="isEditing" class="save-btn" (click)="saveChanges()">
            <mat-icon>save</mat-icon> Lưu thông tin
          </button>          
          <!-- Nút lưu Avatar -->
          <button *ngIf="newAvatarSelected" class="save-avatar-btn" (click)="saveAvatar()">
            <mat-icon>save</mat-icon> Lưu Avatar
          </button>
        </div>
    
        <form>
          <!-- Avatar -->
          <div class="avatar-container">
            <img [src]="user.avatar" alt="Avatar" class="avatar-center" />
            <button mat-icon-button class="edit-avatar-btn" (click)="editAvatar()">
              <i class="fa-solid fa-cloud"></i>
            </button>
            <input type="file" accept="image/*" #fileInput (change)="onFileSelected($event)" hidden />
          </div>
    
          <!-- Form -->
          <div class="form-fields-container">
            <div class="form-row">
              <mat-form-field class="full-width">
                <mat-label>Username</mat-label>
                <input matInput [(ngModel)]="user.username" name="username" [readonly]="!isEditing" />
                <mat-icon matPrefix>person</mat-icon>
              </mat-form-field>
    
              <mat-form-field class="full-width">
                <mat-label>Password</mat-label>
                <input type="password" matInput [(ngModel)]="user.newPassword" name="newPassword" [readonly]="!isEditing" />
              </mat-form-field>
            </div>
    
            <div class="form-row">
              <mat-form-field class="full-width">
                <mat-label>Email</mat-label>
                <input matInput [(ngModel)]="user.email" name="email" [readonly]="!isEditing" />
                <mat-icon matPrefix>email</mat-icon>
              </mat-form-field>
              <mat-form-field class="full-width">
                <mat-label>Full Name</mat-label>
                <input matInput [(ngModel)]="user.fullName" name="fullName" [readonly]="!isEditing" />
                <mat-icon matPrefix>account_circle</mat-icon>
              </mat-form-field>
            </div>
    
            <div class="form-row">
              <mat-form-field class="full-width">
                <mat-label>Phone</mat-label>
                <input matInput [(ngModel)]="user.phone" name="phone" [readonly]="!isEditing" />
                <mat-icon matPrefix>phone</mat-icon>
              </mat-form-field>
              <mat-form-field class="full-width">
                <mat-label>Status</mat-label>
                <input matInput [value]="user.status === 1 ? 'Active' : 'Inactive'" readonly />
                <mat-icon matPrefix>check_circle</mat-icon>
              </mat-form-field>
            </div>
    
            <div class="form-row">
              <mat-form-field class="full-width">
                <mat-label>Created At</mat-label>
                <input matInput [value]="user.createdAt" readonly />
                <mat-icon matPrefix>calendar_today</mat-icon>
              </mat-form-field>
              <mat-form-field class="full-width">
                <mat-label>Updated At</mat-label>
                <input matInput [value]="user.updatedAt" readonly />
                <mat-icon matPrefix>update</mat-icon>
              </mat-form-field>
            </div>
    
            <div class="form-row">
              <mat-form-field class="full-width">
                <mat-label>Roles</mat-label>
                <input matInput [value]="userRoles" readonly />
                <mat-icon matPrefix>group</mat-icon>
              </mat-form-field>
            </div>
          </div>
        </form>
      </div>
    </div>
    

    <!-- Additional Content -->
    <div class="additional-content">
      <router-outlet></router-outlet>
    </div>
    <!-- Footer -->
    <!-- <mat-toolbar color="primary" class="footer-toolbar">
      <div class="footer-left">
        <mat-icon>copyright</mat-icon>
        <span>2025 Serenity. All rights reserved by Mr. Chungcoder !</span>
      </div>
      <div class="footer-right">
        <a mat-button href="#">Privacy Policy</a>
        <a mat-button href="#">Terms of Service</a>
        <a mat-button href="#">Contact Us</a>
      </div>
    </mat-toolbar> -->

  </mat-sidenav-content>
</mat-sidenav-container>